# ç®€å†åˆ†æå®¢æˆ·ç«¯

è¿™æ˜¯ä¸€ä¸ªåŸºäºReactçš„ç®€å†åˆ†æå®¢æˆ·ç«¯åº”ç”¨ï¼Œæ”¯æŒä¸AIåŠ©æ‰‹è¿›è¡Œå®æ—¶å¯¹è¯åˆ†æã€‚

## ä¸»è¦åŠŸèƒ½

- ğŸ“„ ç®€å†æ–‡ä»¶ä¸Šä¼ å’Œåˆ†æ
- ğŸ’¬ å®æ—¶æµå¼å¯¹è¯ä½“éªŒ
- ğŸ”„ æ™ºèƒ½é”™è¯¯å¤„ç†å’Œé‡è¿æœºåˆ¶
- ğŸ—‚ï¸ å¤šå¯¹è¯ç®¡ç†
- ğŸ“± å“åº”å¼è®¾è®¡

## æŠ€æœ¯æ¶æ„

### æµå¼å“åº”ç³»ç»Ÿ

åº”ç”¨é‡‡ç”¨äº†åŸºäºServer-Sent Events (SSE) çš„æµå¼å“åº”ç³»ç»Ÿï¼Œå®Œå…¨æ›¿ä»£äº†ä¼ ç»Ÿçš„è½®è¯¢æœºåˆ¶ï¼š

#### äº‹ä»¶ç±»å‹æ”¯æŒ

- `conversation.chat.created` - å¯¹è¯åˆ›å»º
- `conversation.chat.in_progress` - å¯¹è¯è¿›è¡Œä¸­
- `conversation.message.delta` - æ¶ˆæ¯å¢é‡æ›´æ–°
- `conversation.message.completed` - æ¶ˆæ¯å®Œæˆ
- `conversation.chat.completed` - å¯¹è¯å®Œæˆ
- `conversation.chat.failed` - å¯¹è¯å¤±è´¥

#### æ ¸å¿ƒç»„ä»¶

**ApiClient (`src/services/apiService.js`)**

- å¤„ç†SSEæµå¼å“åº”
- äº‹ä»¶ç±»å‹è§£æå’Œè½¬æ¢
- é”™è¯¯å¤„ç†å’Œé‡è¿é€»è¾‘

**useChat Hook (`src/hooks/useChat.jsx`)**

- ç»Ÿä¸€çš„èŠå¤©çŠ¶æ€ç®¡ç†
- æµå¼æ•°æ®å¤„ç†
- è‡ªåŠ¨é‡è¯•æœºåˆ¶
- å¯¹è¯ç”Ÿå‘½å‘¨æœŸç®¡ç†

**ChatInterface (`src/components/chatBox/ChatInterface.jsx`)**

- å®æ—¶æ¶ˆæ¯æ˜¾ç¤º
- æµå¼å†…å®¹æ¸²æŸ“
- çŠ¶æ€æŒ‡ç¤ºå™¨
- é”™è¯¯æç¤ºå’Œé‡è¿æŒ‰é’®

### çŠ¶æ€ç®¡ç†

åº”ç”¨ä½¿ç”¨äº†å®Œå–„çš„çŠ¶æ€ç®¡ç†ç³»ç»Ÿï¼š

- `chatStatus`: 'idle' | 'in_progress' | 'completed' | 'failed'
- `isStreaming`: æ˜¯å¦æ­£åœ¨æ¥æ”¶æµå¼æ•°æ®
- `streamingContent`: å½“å‰æµå¼å†…å®¹
- `retryCount`: é‡è¯•æ¬¡æ•°
- `isRetrying`: æ˜¯å¦æ­£åœ¨é‡è¯•

### é”™è¯¯å¤„ç†

å®ç°äº†å¤šå±‚çº§çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼š

1. **ç½‘ç»œé”™è¯¯**: è‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼Œæœ€å¤šé‡è¯•3æ¬¡
2. **æœåŠ¡å™¨é”™è¯¯**: æ ¹æ®HTTPçŠ¶æ€ç å†³å®šæ˜¯å¦é‡è¯•
3. **ç”¨æˆ·å–æ¶ˆ**: ä¼˜é›…å¤„ç†ç”¨æˆ·ä¸»åŠ¨å–æ¶ˆçš„è¯·æ±‚
4. **è§£æé”™è¯¯**: å¿½ç•¥JSONè§£æé”™è¯¯ï¼Œç»§ç»­å¤„ç†å…¶ä»–æ•°æ®

### ç”¨æˆ·ä½“éªŒä¼˜åŒ–

- **å®æ—¶åé¦ˆ**: æµå¼å“åº”æä¾›å³æ—¶çš„AIå›å¤
- **çŠ¶æ€æŒ‡ç¤º**: æ¸…æ™°çš„è§†è§‰çŠ¶æ€æŒ‡ç¤ºå™¨
- **é”™è¯¯æ¢å¤**: ä¸€é”®é‡è¿åŠŸèƒ½
- **è¯·æ±‚æ§åˆ¶**: æ”¯æŒå–æ¶ˆæ­£åœ¨è¿›è¡Œçš„è¯·æ±‚

## å¼€å‘æŒ‡å—

### å¯åŠ¨å¼€å‘ç¯å¢ƒ

```bash
npm install
npm run dev
```

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
```

### é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ chatBox/
â”‚   â”‚   â”œâ”€â”€ ChatInterface.jsx    # ä¸»èŠå¤©ç•Œé¢
â”‚   â”‚   â”œâ”€â”€ ChatInput.jsx        # æ¶ˆæ¯è¾“å…¥æ¡†
â”‚   â”‚   â”œâ”€â”€ ChatSendButton.jsx   # å‘é€/å–æ¶ˆæŒ‰é’®
â”‚   â”‚   â””â”€â”€ MessageBox.jsx       # æ¶ˆæ¯æ˜¾ç¤ºç»„ä»¶
â”‚   â””â”€â”€ sidebar/
â”‚       â”œâ”€â”€ ResumeUpload.jsx     # æ–‡ä»¶ä¸Šä¼ 
â”‚       â”œâ”€â”€ ChatList.jsx         # å¯¹è¯åˆ—è¡¨
â”‚       â””â”€â”€ ...
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useChat.jsx              # èŠå¤©çŠ¶æ€ç®¡ç†
â”‚   â””â”€â”€ useAnalysis.jsx          # åˆ†æçŠ¶æ€ç®¡ç†
â”œâ”€â”€ services/
â”‚   â””â”€â”€ apiService.js            # APIå®¢æˆ·ç«¯
â””â”€â”€ pages/
    â””â”€â”€ Analysis.jsx             # åˆ†æé¡µé¢
```

## APIé›†æˆ

### æµå¼å“åº”æ ¼å¼

å®¢æˆ·ç«¯æ”¯æŒæ ‡å‡†çš„SSEæ ¼å¼ï¼š

```
event: conversation.chat.created
data: {"id":"123","conversation_id":"456","status":"created"}

event: conversation.message.delta
data: {"id":"789","role":"assistant","content":"Hello","type":"answer"}

event: conversation.chat.completed
data: {"id":"123","status":"completed","usage":{"token_count":100}}

event: done
data: [DONE]
```

### é”™è¯¯å¤„ç†

APIé”™è¯¯ä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸ºç”¨æˆ·å‹å¥½çš„é”™è¯¯æ¶ˆæ¯ï¼Œå¹¶æ ¹æ®é”™è¯¯ç±»å‹å†³å®šæ˜¯å¦è¿›è¡Œé‡è¯•ã€‚

## æ€§èƒ½ä¼˜åŒ–

- ä½¿ç”¨React.memoä¼˜åŒ–ç»„ä»¶æ¸²æŸ“
- å®ç°äº†åˆç†çš„çŠ¶æ€æ›´æ–°ç­–ç•¥
- å‡å°‘äº†ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“
- ä¼˜åŒ–äº†å†…å­˜ä½¿ç”¨

## æœªæ¥æ”¹è¿›

- [ ] æ·»åŠ æ¶ˆæ¯æœç´¢åŠŸèƒ½
- [ ] å®ç°å¯¹è¯å¯¼å‡ºåŠŸèƒ½
- [ ] æ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼
- [ ] æ·»åŠ å¿«æ·é”®æ”¯æŒ
- [ ] å®ç°ç¦»çº¿æ¨¡å¼
